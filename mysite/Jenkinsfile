pipeline {
  agent any
  stages {
    // build the docker image
    stage('Build Image') {
      steps {
        dir('./mysite') {
         sh "docker build -t djawed22/repo:latest ."
        }
        

      }
    }
    // test the docker image
    stage('Test Image Building') {
      steps {
        sh "docker images "
      }
    }
    // push the docker image to docker hub
    stage('push image') {
      steps {
        
        withCredentials([usernamePassword(credentialsId: 'docker_hub_account', passwordVariable: 'pwd', usernameVariable: 'user')]) {
          sh "docker login -u ${env.user} -p ${env.pwd}"
          sh 'docker push djawed22/repo:latest'
        }
      }
    }

  }
}
