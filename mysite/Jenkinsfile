pipeline {
  agent any
  stages {

    stage('Build Image') {
      steps {
        dir('./mysite') {
         sh "docker build -t djawed22/repo:latest ."
        }
        

      }
    }
    stage('Test Image Building') {
      steps {
        sh "docker ps "
      }
    }
    stage('push image') {
      steps {
        // sh "docker push djawed22/repo:latest"
        withCredentials([usernamePassword(credentialsId: 'docker_hub_account', passwordVariable: 'pwd', usernameVariable: 'user')]) {
          sh "docker login -u ${env.user} -p ${env.pwd}"
          sh 'docker push djawed22/repo:latest'
        }
      }
    }

  }
}
